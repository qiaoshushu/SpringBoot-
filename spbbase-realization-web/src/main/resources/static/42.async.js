(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[42],{LRyE:function(e,t,a){"use strict";var l=a("xK3H"),n=a("3rQ3");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("khen");var r=l(a("3J+T"));a("fhlT");var d=l(a("kXZy"));a("9TwZ");var u=l(a("wOVV"));a("/26P");var c=l(a("aYvq"));a("1pPU");var s=l(a("KjZ1"));a("Lzml");var i=l(a("vpm+"));a("mKhK");var o=l(a("iW5v"));a("/MhY");var f=l(a("w0+5"));a("Ktq0");var m=l(a("fL5V")),p=l(a("SeLb")),h=l(a("Sx57")),v=l(a("4zp0")),E=l(a("iVWQ")),y=l(a("lF+r")),g=l(a("PApH")),b=l(a("8g53"));a("Z2z2");var w=l(a("kI2X"));a("XFd2");var k=l(a("33fr"));a("E2ON");var S=l(a("jjSt"));a("SwZr");var C=l(a("AUq8"));a("Q3sr");var I,M,F,V=l(a("9NP+")),D=n(a("zLBQ")),N=a("LneV"),R=l(a("r27q")),x=l(a("I9Uw")),L=l(a("+kNj")),O=l(a("CkN6")),j=l(a("zHco")),P=l(a("xzfs")),z=L.default.Description,Y=V.default.Item,A=C.default.Step,J=S.default.Option,T=k.default.confirm,K=function(e){return Object.keys(e).map(function(t){return e[t]}).join(",")},q=function(e,t){var a=t.status;return"process"===a?D.default.createElement(w.default,{placement:"topLeft",arrowPointAtCenter:!0},e):e},Z=(I=(0,N.connect)(function(e){var t=e.casedemo,a=e.caseform,l=e.Entrust,n=e.loading;return{casedemo:t,caseform:a,Entrust:l,loading:n.models.casedemo}}),M=V.default.create(),I(F=M(F=function(e){function t(){var e,a;(0,h.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,E.default)(this,(e=(0,y.default)(t)).call.apply(e,[this].concat(n))),a.state={modal1Visible:!1,expandForm:!1,selectedRows:[],formValues:{},visible:!1,stepDirection:"horizontal"},a.handleStandardTableChange=function(e,t,l){var n=a.props.dispatch,r=a.state.formValues,d=Object.keys(t).reduce(function(e,a){var l=(0,p.default)({},e);return l[a]=K(t[a]),l},{}),u=(0,p.default)({currentPage:e.current,pageSize:e.pageSize},r,d);l.field&&(u.sorter="".concat(l.field,"_").concat(l.order)),n({type:"casedemo/fetch",payload:u})},a.handleFormReset=function(){var e=a.props,t=e.form,l=e.dispatch;t.resetFields(),a.setState({formValues:{}}),l({type:"casedemo/fetch",payload:{}})},a.toggleForm=function(){var e=a.state.expandForm;a.setState({expandForm:!e})},a.handJump=function(e){R.default.push({pathname:"/case/advanced",state:{id:e.id}})},a.handJump1=function(e){if(void 0!==e[0]){var t=e[0].id;R.default.push({pathname:"/case/form",state:{ids:t}})}},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearchs=function(){var e=a.props,t=e.dispatch,l=e.form;l.validateFields(function(e,l){if(!e){var n=(0,p.default)({},l);a.setState({formValues:n}),t({type:"casedemo/fetch",payload:n})}})},a.handleSearch=function(e){e.preventDefault();var t=a.props,l=t.dispatch,n=t.form;n.validateFields(function(e,t){if(!e){var n=(0,p.default)({},t,{acceptDate:t.acceptDate&&t.acceptDate.format("YYYY-MM-DD")});a.setState({formValues:n}),l({type:"casedemo/fetch",payload:n})}})},a.handleDelete=function(e){var t=a.props.dispatch,l=a.state.selectedRows;if(l){switch(e.key){case"":break;default:t({type:"casedemo/remove",payload:{key:l.map(function(e){return e.key})},callback:function(){a.setState({selectedRows:[]})}});break}m.default.success("\u5e9f\u9664\u6210\u529f"),a.handleModalVisible()}},a.showModal=function(){var e=a.props.dispatch,t=a.state.selectedRows;new Promise(function(a,l){e({type:"casedemo/queryMaterials",payload:{ids:t.map(function(e){return e.id}),resolve:a,reject:l}})}).then(function(t){if(t.caseMaterial.length>0){for(var a=[],l=0;l<t.caseMaterial.length;l+=1)null!==t.caseMaterial[l].attachmentId&&a.push(t.caseMaterial[l].attachmentId);a.length>0&&e({type:"caseform/fetchAttachMent",payload:a})}}),a.setState({visible:!0})},a.handleOk=function(){a.setState({visible:!1})},a.handleCancel=function(){a.setState({visible:!1})},a.showConfirm=function(){var e=a.props.dispatch,t=a.state.selectedRows,l="\u60a8\u5c06\u5220\u9664\u5b9e\u9a8c\u7f16\u53f7\u4e3a   ",n="    \u7684\u6570\u636e\uff01",r=t.map(function(e){return e.caseNo}),d=l+r+n,u=t.map(function(e){return e.id}),c=(0,b.default)((0,b.default)(a));t&&T({title:"\u786e\u5b9a\u8981\u5220\u9664\u6570\u636e\u5417?",content:d,onOk:function(){new Promise(function(t,a){e({type:"casedemo/remove",payload:{ids:u,resolve:t,reject:a}})}).then(function(e){!0===e&&c.handleSearchs()}),m.default.success("\u5220\u9664\u6210\u529f"),c.setState({selectedRows:[]})},onCancel:function(){}})},a.handleAdd=function(e){var t=a.props.dispatch;t({type:"casedemo/add",payload:{desc:e.desc}}),m.default.success("\u6dfb\u52a0\u6210\u529f"),a.handleModalVisible()},a.showConfirm1=function(){for(var e=a.props.dispatch,t=a.state.selectedRows,l=(0,b.default)((0,b.default)(a)),n="\u60a8\u5c06\u63d0\u4ea4\u6848\u4f8b\u7f16\u53f7\u4e3a",r="\u7684\u6570\u636e\uff01",d=[],u=[],c=t.map(function(e){return e.status}),s=t.map(function(e){return e.caseNo}),i=t.map(function(e){return e.id}),o=0;o<c.length;o+=1)parseInt(c[o],10)===parseInt(0,10)&&(d.push(s[o]),u.push(i[o]));var f=n+d+r;t&&T({title:"\u786e\u5b9a\u8981\u63d0\u4ea4\u6570\u636e\u5417?",content:f,onOk:function(){new Promise(function(t,a){e({type:"casedemo/updateAudit",payload:{ids:u,status:parseInt(1,10),resolve:t,reject:a}})}).then(function(e){!0===e&&l.handleSearchs()}),m.default.success("\u63d0\u4ea4\u6210\u529f!"),l.setState({selectedRows:[]})},onCancel:function(){}})},a}return(0,g.default)(t,e),(0,v.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"casedemo/fetch"}),e({type:"casedemo/caseStates"}),e({type:"Entrust/fetchCategorys"})}},{key:"setModal1Visible",value:function(e){this.setState({modal1Visible:e})}},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.Entrust.Category;return D.default.createElement(V.default,{onSubmit:this.handleSearch,layout:"inline"},D.default.createElement(c.default,{gutter:{md:8,lg:24,xl:48}},D.default.createElement(o.default,{md:8,sm:24},D.default.createElement(Y,{label:"\u6848\u4f8b\u7f16\u53f7"},t("caseNo")(D.default.createElement(f.default,{placeholder:"\u8bf7\u8f93\u5165\u6848\u4f8b\u7f16\u53f7"})))),D.default.createElement(o.default,{md:8,sm:24},D.default.createElement(Y,{label:"\u4e13\u4e1a\u7c7b\u522b"},t("caseCategoryId")(D.default.createElement(S.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},a.map(function(e){return D.default.createElement(J,{key:e.id,value:e.id},e.value)}))))),D.default.createElement(o.default,{md:8,sm:24},D.default.createElement("span",{className:P.default.submitButtons},D.default.createElement(i.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),D.default.createElement(i.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e"),D.default.createElement("a",{style:{marginLeft:8},onClick:this.toggleForm},"\u5c55\u5f00 ",D.default.createElement(s.default,{type:"down"}))))))}},{key:"renderAdvancedForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.casedemo.caseState,l=e.Entrust.Category;return D.default.createElement(V.default,{onSubmit:this.handleSearch,layout:"inline"},D.default.createElement(c.default,{gutter:{md:8,lg:24,xl:48}},D.default.createElement(o.default,{md:8,sm:24},D.default.createElement(Y,{label:"\u6848\u4f8b\u7f16\u53f7"},t("caseNo")(D.default.createElement(f.default,{placeholder:"\u8bf7\u8f93\u5165\u6848\u4f8b\u7f16\u53f7"})))),D.default.createElement(o.default,{md:8,sm:24},D.default.createElement(Y,{label:"\u4e13\u4e1a\u7c7b\u522b"},t("caseCategoryId")(D.default.createElement(S.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},l.map(function(e){return D.default.createElement(J,{key:e.id,value:e.id},e.value)}))))),D.default.createElement(o.default,{md:8,sm:24},D.default.createElement(Y,{label:"\u53d7\u7406\u65e5\u671f"},t("acceptDate")(D.default.createElement(u.default,{style:{width:"100%"}})))),D.default.createElement(o.default,{md:8,sm:24},D.default.createElement(Y,{label:"\u59d4\u6258\u4eba",style:{marginLeft:12}},t("clientName")(D.default.createElement(f.default,{placeholder:"\u8bf7\u8f93\u5165\u59d4\u6258\u4eba\u59d3\u540d"})))),D.default.createElement(o.default,{md:8,sm:24},D.default.createElement(Y,{label:"\u6848\u4ef6\u72b6\u6001"},t("status")(D.default.createElement(S.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},a.map(function(e){return D.default.createElement(J,{key:e.id,value:e.id},e.value)})))))),D.default.createElement("div",{style:{overflow:"hidden"}},D.default.createElement("div",{style:{float:"right",marginBottom:24}},D.default.createElement(i.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),D.default.createElement(i.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e"),D.default.createElement("a",{style:{marginLeft:8},onClick:this.toggleForm},"\u6536\u8d77 ",D.default.createElement(s.default,{type:"up"})))))}},{key:"renderForm",value:function(){var e=this.state.expandForm;return e?this.renderAdvancedForm():this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.casedemo,l=a.data,n=a.caseState,u=a.caseMater,c=t.loading,s=t.caseform.attachmentList,o=t.Entrust.Category;console.log(l,"data");var f=this.state,m=f.selectedRows,p=f.stepDirection,h=f.modal1Visible,v=f.visible,E=m.map(function(e){return e.caseNo}),y=parseInt(m.map(function(e){return e.status}),10),g=0;0!==y&&1!==y&&2!==y||(g=parseInt(0,10)),y>2&&y<7&&(g=parseInt(1,10)),y>6&&y<9&&(g=parseInt(2,10)),9===y&&(g=parseInt(3,10)),y>9&&(g=parseInt(4,10));var b=[{title:"\u6848\u4f8b\u7f16\u53f7",dataIndex:"caseNo",align:"center",render:function(t,a){return D.default.createElement(D.Fragment,null,D.default.createElement("a",{onClick:function(){return e.handJump(a)}},a.caseNo))}},{title:"\u4e13\u4e1a\u7c7b\u522b",dataIndex:"caseCategoryId",align:"center",render:function(e){var t=o.filter(function(t){return parseInt(t.id,10)===parseInt(e,10)});return t.length>0?t[0].value:e}},{title:"\u53d7\u7406\u65e5\u671f",dataIndex:"acceptDate",align:"center",render:function(e){return null!==e?D.default.createElement("span",null,(0,x.default)(e).format("YYYY-MM-DD")):e}},{title:"\u59d4\u6258\u65b9",dataIndex:"clientName",align:"center"},{title:"\u6848\u4ef6\u72b6\u6001",dataIndex:"status",align:"center",render:function(e){var t=n.filter(function(t){return parseInt(t.id,10)===parseInt(e,10)}),a=t.length>0?t[0].value:e;return a}},{title:"\u91d1\u989d",dataIndex:"totalPrice",align:"center"},{title:"\u5907\u6ce8",dataIndex:"remark",align:"center"}];return D.default.createElement(j.default,{title:"\u6848\u4ef6\u5217\u8868"},D.default.createElement(d.default,{bordered:!1},D.default.createElement("div",{className:P.default.tableList},D.default.createElement("div",{className:P.default.tableListForm},this.renderForm()),D.default.createElement("div",{className:P.default.tableListOperator},D.default.createElement("span",null,D.default.createElement(i.default,{disabled:1!==m.length,onClick:function(){return e.handJump1(m)}},"\u4fee\u6539"),D.default.createElement(i.default,{disabled:0===m.length||0===m.filter(function(e){return 0===parseInt(e.status,10)}).length,onClick:this.showConfirm1},"\u63d0\u4ea4\u5ba1\u6838"),D.default.createElement(i.default,{type:"danger",disabled:0===m.length,onClick:this.showConfirm},"\u5220\u9664"),D.default.createElement(i.default,{disabled:1!==m.length,onClick:this.showModal},"\u9274\u5b9a\u6750\u6599"),D.default.createElement(i.default,{disabled:1!==m.length,onClick:function(){return e.setModal1Visible(!0)}},"\u72b6\u6001\u8bb0\u5f55"))),D.default.createElement(k.default,{width:700,title:"\u7f16\u53f7\u4e3a: ".concat(E," \u7684\u9274\u5b9a\u6750\u6599\u8be6\u60c5"),visible:v,onOk:this.handleOk,onCancel:this.handleCancel},function(){if(void 0===u.caseMaterial)return D.default.createElement("span",null,"\u6682\u65e0\u6570\u636e");if(0===u.caseMaterial.length)return D.default.createElement("span",null,"\u6682\u65e0\u6570\u636e");if(u.caseMaterial.length>0){var e=function(){for(var e=u.caseMaterial,t=[],a=function(a){var l=e[a].attachmentId,n=null;if(null!==l){var d=s.filter(function(t){return t.id===e[a].attachmentId});n=d.length>0?d[0].fileName:null}t.push(D.default.createElement(L.default,{key:e[a].id,size:"large",title:"\u9274\u5b9a\u6750\u6599 ".concat(a+1," "),style:{marginBottom:32}},D.default.createElement(z,{term:"\u9001\u68c0\u6750\u6599\u540d\u79f0"},e[a].name),D.default.createElement(z,{term:"\u7c7b\u578b"},e[a].type),D.default.createElement(z,{term:"\u6570\u91cf"},e[a].amount),D.default.createElement(z,{term:"\u89c4\u683c"},e[a].specification),D.default.createElement(z,{term:"\u6750\u6599\u6027\u8d28"},e[a].feature),D.default.createElement(z,{term:"\u5907\u6ce8"},e[a].remark),D.default.createElement(z,{term:null!==n?"\u6587\u4ef6\u4e0b\u8f7d":null},D.default.createElement(r.default,null,D.default.createElement("a",{href:"/spbbase-attachment-web/api/attachment/{id}/download?id=".concat(l)},null!==n?"\u4e0b\u8f7d":null))),D.default.createElement(z,{term:null!==n?"\u6587\u4ef6":null},null!==n?n:"")))},l=0;l<e.length;l+=1)a(l);return{v:D.default.createElement(d.default,null,t)}}();if("object"===typeof e)return e.v}}()),D.default.createElement(k.default,{width:900,title:"\u7f16\u53f7\u4e3a: ".concat(E," \u7684\u72b6\u6001\u8bb0\u5f55"),visible:h,onOk:function(){return e.setModal1Visible(!1)},onCancel:function(){return e.setModal1Visible(!1)},footer:null},D.default.createElement(C.default,{direction:p,progressDot:q,current:g},D.default.createElement(A,{title:"\u6848\u4f8b\u767b\u8bb0"}),D.default.createElement(A,{title:"\u5b9e\u9a8c\u4e2d"}),D.default.createElement(A,{title:"\u51fa\u62a5\u544a"}),D.default.createElement(A,{title:"\u90ae\u5bc4"}),D.default.createElement(A,{title:"\u5b8c\u6210"}))),D.default.createElement(O.default,{rowKey:"id",selectedRows:m,loading:c,data:l,columns:b,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))))}}]),t}(D.PureComponent))||F)||F),B=Z;t.default=B}}]);