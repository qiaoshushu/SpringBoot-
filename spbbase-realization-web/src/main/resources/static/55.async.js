(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[55],{"70ja":function(e,t,a){"use strict";var n=a("xK3H"),l=a("3rQ3");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("fhlT");var d=n(a("kXZy")),r=n(a("dnxz"));a("Z2z2");var i=n(a("kI2X"));a("Ktq0");var o=n(a("fL5V")),u=n(a("8g53"));a("Lzml");var s=n(a("vpm+"));a("/26P");var c=n(a("aYvq"));a("9TwZ");var f=n(a("wOVV"));a("E2ON");var m=n(a("jjSt"));a("mKhK");var p=n(a("iW5v")),h=n(a("SeLb")),v=n(a("Sx57")),g=n(a("4zp0")),y=n(a("iVWQ")),R=n(a("lF+r")),S=n(a("PApH"));a("Q3sr");var M=n(a("9NP+"));a("XFd2");var w=n(a("33fr"));a("/MhY");var E,b,k,C,V,F,I,O=n(a("w0+5")),A=l(a("zLBQ")),z=n(a("zHco")),x=n(a("CkN6")),D=n(a("kxm8")),N=a("LneV"),L=n(a("I9Uw")),B=O.default.TextArea,P=w.default.confirm,Y=M.default.Item,T=(E=M.default.create(),E(b=function(e){function t(){var e,a;(0,v.default)(this,t);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return a=(0,y.default)(this,(e=(0,R.default)(t)).call.apply(e,[this].concat(l))),a.state={caseList:[]},a.onOk=function(){var e=a.props,t=e.form.validateFields,n=e.handleModal2Ok,l=e.selectedRows,d=l.map(function(e){return e.idString}),r=[],i=l.map(function(e){return e.financeRefundBillBizEntity.bizIdString});t(function(e,t){for(var l in d){var o={id:d[l],reason:t.reason,status:6,bizId:i[l]};r.push(o)}e||a.setState(function(){n(r)})})},a.onCancel=function(){var e=a.props.auditeModalonCancel;a.setState(function(){e()})},a}return(0,S.default)(t,e),(0,g.default)(t,[{key:"render",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.AddModalVisable,n=e.selectedRows;n.map(function(e){return e.idString});return A.default.createElement(w.default,{title:"\u5ba1\u6838\u4e0d\u901a\u8fc7\u539f\u56e0\uff1a",visible:a,width:700,onOk:this.onOk,onCancel:this.onCancel},A.default.createElement(Y,{key:"remark"},t("reason",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e0d\u901a\u8fc7\u539f\u56e0\uff01"}]})(A.default.createElement(B,{autosize:{minRows:4,maxRows:8}}))))}}]),t}(A.PureComponent))||b),K=(k=M.default.create(),k(C=function(e){function t(){var e,a;(0,v.default)(this,t);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return a=(0,y.default)(this,(e=(0,R.default)(t)).call.apply(e,[this].concat(l))),a.category=["\u4eb2\u5b50\u9274\u5b9a","\u6587\u4e66\u9274\u5b9a","\u9152\u7cbe\u9274\u5b9a","\u8f66\u8f86\u75d5\u8ff9\u9274\u5b9a","\u6cd5\u533b\u4e34\u5e8a\u9274\u5b9a","\u6cd5\u533b\u75c5\u7406\u9274\u5b9a"],a.refundType=["\u5168\u90e8","\u9274\u5b9a\u8d39","\u9644\u52a0\u8d39","\u4f1a\u8bca\u8d39","\u73b0\u52d8\u8d39","\u51fa\u5ead\u8d39","\u670d\u52a1\u8d39","\u52a0\u6025\u8d39"],a.handleSearch=function(e){var t=a.props,n=t.form,l=t.handleSearch;e.preventDefault(),n.validateFields(function(e,t){if(!e){var n=(0,h.default)({},t,{refundDate:t.refundDate&&t.refundDate.format("YYYY-MM-DD")});a.setState(function(){l(n)})}})},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.handleFormReset;t.resetFields(),a.setState(function(){n()})},a}return(0,S.default)(t,e),(0,g.default)(t,[{key:"renderSearchForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.remittanceState;return A.default.createElement(M.default,{onSubmit:this.handleSearch,layout:"inline",className:D.default.searchForm},A.default.createElement(c.default,{gutter:{md:8,lg:24,xl:48}},A.default.createElement(p.default,{md:8,sm:24},A.default.createElement(Y,{label:"\u9000\u6b3e\u5355\u53f7"},t("id")(A.default.createElement(O.default,{placeholder:"\u8bf7\u8f93\u5165\u9000\u6b3e\u5355\u53f7"})))),A.default.createElement(p.default,{md:8,sm:24},A.default.createElement(Y,{label:"\u9000\u6b3e\u72b6\u6001"},t("status")(A.default.createElement(m.default,{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},a.map(function(e){return A.default.createElement(Option,{key:e.id,value:e.id},e.value)}))))),A.default.createElement(p.default,{md:8,sm:24},A.default.createElement(Y,{label:"\u9000\u6b3e\u65f6\u95f4"},t("refundDate")(A.default.createElement(f.default,{style:{width:"100%"}}))))),A.default.createElement(c.default,{gutter:{md:8,lg:24,xl:48}},A.default.createElement(p.default,{md:24,sm:24},A.default.createElement("div",{style:{float:"right",marginBottom:24,paddingRight:16}},A.default.createElement(s.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),A.default.createElement(s.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e")))))}},{key:"render",value:function(){return A.default.createElement("div",null,this.renderSearchForm())}}]),t}(A.PureComponent))||C),j=(V=(0,N.connect)(function(e){var t=e.RefundModal,a=e.casereview,n=e.loading;return{RefundModal:t,casereview:a,loading:n.models.RefundModal}}),F=M.default.create(),V(I=F(I=function(e){function t(){var e,a;(0,v.default)(this,t);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return a=(0,y.default)(this,(e=(0,R.default)(t)).call.apply(e,[this].concat(l))),a.state={selectedRow:{},selectedRows:[],NoteModalVisable:!1,AddModalVisable:!1,formValues:{},stepFormValues:{},modalVisible:!1,caseList:[]},a.handleFormReset=function(){var e=a.props.dispatch;e({type:"RefundModal/fetch",payload:{}})},a.handleStandardTableChange=function(e){var t=a.props.dispatch,n=a.state.formValues,l=(0,h.default)({currentPage:e.current,pageSize:e.pageSize},n);t({type:"RefundModal/fetch",payload:l})},a.handleSelectRows=function(e){a.setState({selectedRows:e,selectedRow:e[0]})},a.add=function(){a.setState({AddModalVisable:!0})},a.remove=function(){var e=a.props.dispatch,t=a.state.selectedRows,n=t.map(function(e){return e.idString}),l=t.map(function(e){return e.financeRefundBillBizEntity.idString}),d=(0,u.default)((0,u.default)(a));P({title:"\u786e\u5b9a\u8981\u5220\u9664\u6570\u636e\u5417?",onOk:function(){e({type:"RefundModal/remove",payload:{ids:n,rebbids:l}}),o.default.success("\u5220\u9664\u6210\u529f"),d.setState({selectedRows:[]}),d.handleFormReset()},onCancel:function(){}})},a.handleAudit=function(){a.setState({AddModalVisable:!0})},a.showConfirms=function(){var e=a.props.dispatch,t=a.state,n=t.selectedRows,l=t.caseList,d=(t.selectedRow,"\u60a8\u5c06\u5ba1\u6838\u901a\u8fc7\u7f16\u53f7\u4e3a   "),r="    \u7684\u6570\u636e\uff01",i=n.map(function(e){return e.length}),s=n.map(function(e){return e.idString}),c=n.map(function(e){return e.remittanceBillEntity.idString}),f=d+s+i+r,m=(0,u.default)((0,u.default)(a));if(n){for(var p in s){var h={id:s[p],status:5,bizId:c[p]};l.push(h)}P({title:"\u786e\u5b9a\u8981\u5ba1\u6838\u901a\u8fc7\u5417?",content:f,onOk:function(){e({type:"RefundModal/update",payload:l}),o.default.success("\u5ba1\u6838\u6210\u529f"),m.setState({selectedRows:[]}),m.handleFormReset()},onCancel:function(){}})}},a.handleUpdate=function(e){var t=a.props.dispatch;t({type:"RefundModal/update",payload:{id:e.idString,name:e.name,caseCategoryId:e.caseCategoryId,chargingType:e.chargingType,unitPrice:e.unitPrice}}),o.default.success("\u4fee\u6539\u6210\u529f"),a.updataModalonOk(),a.setState({selectedRows:[]}),a.handleFormReset()},a.updataModalonOk=function(){a.setState({NoteModalVisable:!1})},a.auditModalonOk=function(){a.setState({AddModalVisable:!1})},a.auditeModalonCancel=function(){a.setState({AddModalVisable:!1})},a.handleModal2Ok=function(e){var t=a.props.dispatch;t({type:"RefundModal/updateReasons",payload:e}),o.default.success("\u64cd\u4f5c\u6210\u529f"),a.auditModalonOk(),a.setState({selectedRows:[]}),a.handleFormReset()},a.updataModalonCancel=function(){a.setState({NoteModalVisable:!1})},a.addModalonOk=function(){a.setState({AddModalVisable:!1})},a.addModalonCancel=function(){a.setState({AddModalVisable:!1})},a.handleSearch=function(e){var t=a.props.dispatch;t({type:"RefundModal/fetch",payload:(0,h.default)({},e)})},a}return(0,S.default)(t,e),(0,g.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"RefundModal/fetch",payload:{}}),e({type:"RefundModal/getCaseInfos"}),e({type:"casereview/remittanceStates"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.RefundModal,n=a.data,l=a.CaseInfos,o=t.casereview.remittanceState,u=t.loading;console.log(n);var c=this.state,f=c.selectedRows,m=c.AddModalVisable,p=c.selectedRow;if(void 0!==n&&void 0!==n.list&&0!==n.list.length)for(var h=function(e){if(void 0!==l&&void 0!==l.list){var t=l.list.filter(function(t){return t.id===n.list[e].financeRefundBillBizEntity.bizIdString});n.list[e].caseNo=t.length>0?t[0].caseNo:0}},v=0;v<n.list.length;v+=1)h(v);var g=[{title:"\u9000\u6b3e\u5355\u53f7",dataIndex:"idString",align:"center"},{title:"\u6848\u4f8b\u7f16\u53f7",dataIndex:"caseNo",align:"center"},{title:"\u9000\u6b3e\u91d1\u989d",dataIndex:"money",align:"center"},{title:"\u4e0d\u9000\u91d1\u989d",dataIndex:"deduction",align:"center"},{title:"\u9000\u6b3e\u65f6\u95f4",dataIndex:"refundDate",align:"center",render:function(e){return A.default.createElement("span",null,(0,L.default)(e).format("YYYY-MM-DD"))}},{title:"\u9000\u6b3e\u72b6\u6001",dataIndex:"status",align:"center",render:function(e,t){var a=o.filter(function(t){return parseInt(t.id,10)===parseInt(e,10)}),n=a.length>0?a[0].value:e;return 6===e?A.default.createElement(i.default,{content:"\u4e0d\u901a\u8fc7\u539f\u56e0\uff1a".concat(t.remittanceBillEntity.reason),title:n,trigger:"hover"},A.default.createElement("a",null,n)):0===e?void 0:n}},{title:"\u5907\u6ce8",dataIndex:"remark",align:"center"}],y={auditModalonOk:this.auditModalonOk,auditeModalonCancel:this.auditeModalonCancel,handleModal2Ok:this.handleModal2Ok},R={handleSearch:this.handleSearch,handleFormReset:this.handleFormReset};return A.default.createElement(z.default,{title:"\u9000\u6b3e\u7ba1\u7406"},A.default.createElement(d.default,{bordered:!1},A.default.createElement(K,(0,r.default)({remittanceState:o},R)),A.default.createElement("div",{className:D.default.tableList},A.default.createElement("div",{className:D.default.tableListOperator},A.default.createElement("span",null,A.default.createElement(s.default,{onClick:this.showConfirms,type:"primary",disabled:0===f.length||f.filter(function(e){return 5===parseInt(e.status,10)}).length>0},"\u5ba1\u6838\u901a\u8fc7"),A.default.createElement(s.default,{onClick:function(){return e.handleAudit()},type:"danger",disabled:0===f.length||f.filter(function(e){return 6===e.status}).length>0},"\u5ba1\u6838\u4e0d\u901a\u8fc7"),A.default.createElement(s.default,{onClick:this.remove,type:"danger",disabled:0===f.length},"\u5220\u9664"))),A.default.createElement(x.default,{rowKey:"idString",selectedRows:f,selectedRow:p,columns:g,data:n,loading:u,onChange:this.handleStandardTableChange,onSelectRow:this.handleSelectRows}))),A.default.createElement(T,(0,r.default)({},y,{AddModalVisable:m,selectedRows:f})))}}]),t}(A.PureComponent))||I)||I),Q=j;t.default=Q}}]);